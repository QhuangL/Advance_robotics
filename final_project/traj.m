function [qd, vd, ad, jd, dd] = traj(t, t0)

l1 = 1;
l2 = 1;
m1 = 2;
m2 = 2;
lc1 = 0.5;
lc2 = 0;
I1 = m1*l1^2/12;
I2 = m2*l2^2/3;
g = 9.8;
k = 10;


x10 = 37.4/180*pi;
x20 = 0;
x30 = 142.6/180*pi;
x40 = 0;
a30 = -25.5516;
j40 = 0;

x1f = 60/180*pi;
x2f = 0;
x3f = 120/180*pi;
x4f = 0;
a3f = -19.6350;
j4f = 0;

q0 = x10 + x30;
q2 = x1f + x3f;
v0 = 0;
v2 = 0;
a0 = a30;
a2 = a3f;
j0 = j40;
j2 = j4f;

M = [1 0 0 0 0 0 0 0;
     0 1 0 0 0 0 0 0;
     0 0 2 0 0 0 0 0;
     0 0 0 6 0 0 0 0;
     1 t0 t0^2 t0^3 t0^4 t0^5 t0^6 t0^7;
     0 1  2*t0 3*t0^2 4*t0^3 5*t0^4 6*t0^5 7*t0^6;
     0 0  2    6*t0   12*t0^2 20*t0^3 30*t0^4 42*t0^5;
     0 0  0    6      24*t0   60*t0^2 120*t0^3 210*t0^4];
 
 b = [q0; v0; a0; j0; q2; v2; a2; j2];
 a = inv(M)*b;
 
 c = ones(size(t));
 
 qd = a(1).*c+a(2).*t +a(3).*t.^2+a(4).*t.^3 + a(5).*t.^4 + a(6).*t.^5 + a(7).*t.^6 + a(8).*t.^7; 
 vd = a(2).*c+2*a(3).*t +3*a(4).*t.^2 + 4*a(5).*t.^3 + 5*a(6).*t.^4+ 6*a(7).*t.^5 + 7*a(8).*t.^6; 
 ad = 2*a(3).*c + 6*a(4).*t + 12 *a(5).*t.^2 + 20 *a(6).*t.^3 + 30 *a(7).*t.^4 + 42 *a(8).*t.^5;
 jd = 6*a(4).*c + 24 *a(5).*t + 60 * a(6).*t.^2 + 120 *a(7).*t.^3 + 210 *a(8).*t.^4;
 dd = 24 *a(5).*c + 120 * a(6).*t + 360 *a(7).*t.^2 + 840 *a(8).*t.^3;





